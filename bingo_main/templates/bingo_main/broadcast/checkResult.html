{% load static %}
{% load i18n %}
{% get_current_language as lang %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PolyBingo</title>
    <link rel="icon" type="image/x-icon" href="{% static 'images/polybingo-logotype-new.png' %}" />
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="{% static 'broadcast/css/global.css' %}">
    <link rel="stylesheet" href="{% static 'broadcast/css/cardCheck.css' %}">
    <link rel="stylesheet" href="{% static 'broadcast/css/broadcastIndex.css' %}">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <script src="{% static 'js/dropzone.js' %}"></script>
    <script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    
    <script src="{% static 'js/confetti.js' %}"></script>
    
</head>

<body {% if lang == 'he' %} dir='rtl' align='right' {% else %} style="text-align: left;" {% endif %}>
   

    <div id="landscapeOnly">
        <span>
            {% trans 'Please rotate your device to continue' %}
        </span>
    </div>
    <style>
        
.check-field {
    max-width: 100px;
    max-height: 100px;
}

.bingoTable {
    grid-template-columns: repeat(7, 1fr);
    grid-template-rows: repeat(7, 1fr);
    display: grid;
    height: 100%;
    width: 100%;
    text-align: center;
    justify-content: center;
    margin: auto;
    padding-top: 5px;
    margin: 10px;
}

.bingoTable3x3 {
    grid-template-columns: repeat(3, 0.2fr);
    grid-template-rows: repeat(3, 0.2fr);
    grid-gap: 20px;
    display: grid;
    height: 100%;
    width: 100%;
    text-align: center;
    justify-content: center;
    padding-top: 5px;
    margin: 20px;
    margin-top: 10px;
}


.bingoTable4x4 {
    grid-template-columns: repeat(4, 0.2fr);
    grid-template-rows: repeat(4, 0.2fr);
    grid-gap: 30px;
    display: grid;
    height: 100%;
    width: 100%;
    text-align: center;
    justify-content: center;
    padding-top: 5px;
    margin: 20px;
    margin-top: 0px;
}

.bingoTable5x5 {
    grid-template-columns: repeat(5, 0.2fr);
    grid-template-rows: repeat(5, 0.2fr);
    grid-gap: 20px;
    display: grid;
    height: 100%;
    width: 100%;
    text-align: center;
    justify-content: center;
    padding-top: 5px;
    margin: 20px;
    margin-top: 0px;
}



.check-innerContainer {
    margin: 0;
    transition: 0.5s all;
    min-width: 0;
    font-size: 1.3em;
    border: 5px solid black;
    background-color: white;
    -o-border-image: url({% static 'images/borderdesign.png' %}) 40%;
    border-image: url({% static 'images/borderdesign.png' %}) 40%;
    display: grid;
    padding: 20px;
    grid-template-rows: 1fr auto;
    text-align: center;
    height: 100%;
    /*
    justify-content: center;
    align-items: center;
    */
}
    </style>
    <div class="alignCenter">
        
        {% include "bingo_main/partials/_prizes_sidebar.html" %}

        <div id="positionWrapping">
            <div class="check-innerContainer" id="enterPin">
                <table style="width: 100%; margin-top: 1rem">
                    <tr>
                        <td style="width: 60%; border-right: 2px solid black;">
                            <h3 style="font-family: inherit;"> {% trans 'Shown Pictures' %}</h3>
                            <div class="bingoContainer">
                                <div class="bingoBox">
                                    <div class="bingoTable">
                                        {% for pic in current_shown_pictures %}
                                        <div class="check-field"><img src="{{ pic.image_file.url }}" alt=""></div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="vertical-align: top;">
                           <h3 style="font-family: inherit;"> {% trans 'Player' %} {{ player.nickname }} {% trans 'card' %}</h3>
                           {% if board.size == 3 %} 
                            <div class="bingoTable3x3">
                            {% elif board.size == 4 %}
                            <div class="bingoTable4x4">
                            {% elif board.size == 5 %}
                            <div class="bingoTable5x5">
                            {% else %}
                                <div class="bingoTable5x5">
                            {% endif %}
                                {% for pic in board_pictures %}
                                    <div class="check-field">
                                        <img src="{{ pic.image.image_file.url }}" alt="" {% if pic.matched %} style="border: 10px solid red;" {% endif %}>
                                        {% if pic.matched %}
                                        <!-- <i class="fa fa-arrow-up fa-1x"></i> -->
                                        {% endif %}
                                        
                                    </div>
                                {% endfor %}
                            </div>            
                        </td>
                    </tr>
                </table>
                        {% if check_result == 'WIN' %}
                        {% trans 'Congratulations' %}
                        <br>
                        <span>{% trans 'Card Number' %} {{ board_number }} {% trans 'WON' %} 
                        {% if prize_1 %} {{ current_game.prize_1_name }} {% elif prize_2 %} {{ current_game.prize_2_name }} 
                            {% elif prize_3 %} {{ current_game.prize_3_name }} {% endif %}</span>
                            <script>
                                startConfetti();
                            </script>    
                        {% else %}
                        <div class="row">
                            <span>{% trans 'Card Number' %} {{ board_number }}: {% trans 'Not yet' %}</span>
                        </div>

                        {% endif %}

                        <div class="bottomButtons">
                    <a class="button Check" style="font-family: inherit;"
                        href="{% url 'bingo_main:check_board' game_id=current_game.game_id %}">{% trans 'Check another' %}</a>
                    <a class="button green" style="font-family: inherit;"
                        href="{% url 'bingo_main:game' game_id=current_game.game_id %}">{% trans 'Continue' %}</a>
                </div>
            </div>
        </div>
    </div>
    
    <script>

        function resize() {
            // Reset
            document.querySelector('#prizeContainer').style = '';
            document.querySelector('#winCondition').style = '';
            document.querySelector('.check-innerContainer').style = '';
            //document.querySelector('.speaker').style = '';

            document.querySelector('body').style.height = window.innerHeight + 'px';

            // Resize bingo box to be the same height as the image
            const prizeSectionHeight = document.querySelector('#prize').clientHeight;
            prizeContainers = document.querySelectorAll('#prizeContainer');
            
            for (let index = 0; index != prizeContainers.length; index++) {
                prizeContainers[index].style.maxHeight = prizeSectionHeight / 3 + 'px';
            }


            document.querySelector('#winCondition').style.maxHeight = document.querySelector('.check-innerContainer').clientHeight + 'px';
            document.querySelector('#landscapeOnly').style.height = window.innerHeight + 'px';
        }

        resize();
        
        window.addEventListener('resize', function (e) {
            resize();
        });
 
        
        
    </script>

</body>

</html>